<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sonali Mohil | Home</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
</head>

<body>
  <!-- Header -->
  <header class="site-header">
    <div class="container header-inner">
      <a href="index.html" class="brand">Sonali Mohil</a>
      <nav class="nav">
        <a href="index.html" class="active">Home</a>
        <a href="blog.html">Blog</a>
        <a href="analysis.html">Analysis</a>
        <a href="vlogs.html">Vlogs</a>
        <a href="gallery.html">Gallery</a>
        <a href="about.html">About</a>
      </nav>
    </div>
  </header>

  <!-- Hero Section -->
  <section class="hero" style="background-image: url('https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=2000&q=80');">
    <div class="hero-overlay">
      <div class="hero-inner">
        <h1 class="hero-title">Stories. Thoughts. Journeys.</h1>
        <p class="hero-sub">Exploring worlds within and beyond ‚Äî through words, films, and places.</p>
        <a href="#posts" class="btn primary">Read My Posts</a>
        <a href="gallery.html" class="btn ghost">View Gallery</a>
      </div>
    </div>
  </section>

  <!-- Featured Essay Section -->
  <main class="container">
    <section class="main-grid">
      <div class="feature card">
        <img src="https://images.unsplash.com/photo-1503342217505-b0a15ec3261c?auto=format&fit=crop&w=1200&q=80" alt="Open book with coffee">
        <div class="card-body">
          <h2>Featured Essay</h2>
          <h3>The Art of Being Alone</h3>
          <p>Solitude isn‚Äôt silence. It‚Äôs the subtle conversation between who we are and who we want to be. 
          Here‚Äôs how I learned to listen to that voice ‚Äî between mountains, books, and music.</p>
          <a href="blog.html" class="read-more">Continue reading ‚Üí</a>
        </div>
      </div>

      <!-- Sidebar -->
      <aside class="side">
        <div class="widget card">
          <div class="card-body">
            <h3>Favourite Author</h3>
            <img src="https://upload.wikimedia.org/wikipedia/commons/1/16/Fyodor_Dostoyevsky_portrait.jpg" alt="Fyodor Dostoevsky" style="width:100%; border-radius:8px; margin-top:0.5rem;">
            <p><em>‚ÄúTo go wrong in one‚Äôs own way is better than to go right in someone else‚Äôs.‚Äù</em><br>‚Äî Fyodor Dostoevsky</p>
          </div>
        </div>

        <div class="widget card">
          <div class="card-body">
            <h3>Instagram</h3>
            <p>Follow my travels, reads & reflections:</p>
            <a href="https://instagram.com/sonalimohil" target="_blank" class="read-more">@sanalimohil</a>
          </div>
        </div>
      </aside>
    </section>
  </main>

  <!-- Blog Section -->
  <section id="blog-section" class="container">
    <div id="loginSection">
      <h3>Login (Admin Only)</h3>
      <input type="email" id="loginEmail" placeholder="Email"><br>
      <input type="password" id="loginPassword" placeholder="Password"><br>
      <button onclick="firebaseLogin()">Login</button>
    </div>

    <div id="editorSection" style="display:none;">
      <h3>Write a Blog Post</h3>
      <input type="text" id="titleInput" placeholder="Blog Title"><br>
      <textarea id="contentInput" placeholder="Write your content..." rows="5"></textarea><br>
      <input type="file" id="imageInput"><br>
      <button onclick="addPost()">Publish</button>
      <button onclick="firebaseLogout()">Logout</button>
    </div>

    <hr>
    <div id="posts"></div>
  </section>

  <!-- Quote Banner -->
  <section class="quote-banner">
    ‚ÄúSubconscious marches to its own beat.‚Äù ‚Äî Sonali Mohil
  </section>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="container footer-inner">
      <p>¬© <span id="year"></span> Sonali Mohil</p>
      <div class="social">
        <a href="https://instagram.com/sonalimohil" target="_blank">Instagram</a> ‚Ä¢
        <a href="mailto:mohilsonali@gmail.com">Email me</a>
      </div>
    </div>
  </footer>

  <script src="scripts.js"></script>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-storage-compat.js"></script>

  <!-- Firebase Config + Logic -->
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCtgKE7qG2tzSzKZNRiPv75iJbhAq9kuEM",
      authDomain: "sonali-blog-fb45c.firebaseapp.com",
      projectId: "sonali-blog-fb45c",
      storageBucket: "sonali-blog-fb45c.firebasestorage.app",
      messagingSenderId: "93112358664",
      appId: "1:93112358664:web:18563c797efa403f5f3ebd",
      measurementId: "G-NQ4QQQ8WWJ"
    };

    // üî• Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
    const storage = firebase.storage();

    // üîí Your UID (only you can post)
    const ADMIN_UID = "Qlk1Jfcay1e31Fqay8dJU6tC96i1";

    // ----- LOGIN -----
    async function firebaseLogin() {
      const email = document.getElementById("loginEmail").value;
      const password = document.getElementById("loginPassword").value;
      try {
        await auth.signInWithEmailAndPassword(email, password);
        alert("Welcome, Sonali!");
        onAuthChanged();
      } catch (err) {
        alert("Login failed: " + err.message);
      }
    }

    function firebaseLogout() {
      auth.signOut();
    }

    // ----- AUTH STATE -----
    function onAuthChanged() {
      auth.onAuthStateChanged(user => {
        if (user && user.uid === ADMIN_UID) {
          document.getElementById("editorSection").style.display = "block";
          document.getElementById("loginSection").style.display = "none";
        } else {
          document.getElementById("editorSection").style.display = "none";
          document.getElementById("loginSection").style.display = "block";
        }
      });
    }
    onAuthChanged();

    // ----- ADD BLOG POST -----
    async function addPost() {
      const title = document.getElementById("titleInput").value;
      const content = document.getElementById("contentInput").value;
      const file = document.getElementById("imageInput").files[0];
      let imageUrl = "";

      if (file) {
        const ref = storage.ref('images/' + Date.now() + '_' + file.name);
        await ref.put(file);
        imageUrl = await ref.getDownloadURL();
      }

      await db.collection("posts").add({
        title,
        content,
        imageUrl,
        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
        authorUID: auth.currentUser.uid
      });

      document.getElementById("titleInput").value = "";
      document.getElementById("contentInput").value = "";
      document.getElementById("imageInput").value = "";

      loadPosts();
    }

    // ----- SHOW BLOG POSTS -----
    async function loadPosts() {
      const postsContainer = document.getElementById("posts");
      postsContainer.innerHTML = "";
      const qs = await db.collection("posts").orderBy("createdAt", "desc").get();
      qs.forEach(doc => {
        const p = doc.data();
        const div = document.createElement("div");
        div.className = "post";
        div.innerHTML = `
          <h2>${p.title}</h2>
          <p>${p.content}</p>
          ${p.imageUrl ? '<img src="'+p.imageUrl+'" style="max-width:100%;border-radius:10px;">' : ''}
        `;
        postsContainer.appendChild(div);
      });
    }

    loadPosts();
  </script>
</body>
</html>
